#textdomain wesnoth-Electrifyre

[scenario]
    id=02_Southern_Sojourn
    next_scenario=03_Fogbound_Valley
    name=_"Southern Sojourn"

    map_file=02_Southern_Sojourn.map

    victory_when_enemies_defeated=no
    {TURNS 24 22 20}
    {CAMPAIGN_XP_MODIFIER}
    
    {DEFAULT_MUSIC_PLAYLIST}
    {DEFAULT_SCHEDULE}

    {STORY_TWO}

    # side: player
    [side]
        side=1
        controller=human
        
        {CHARACTER_STATS:HIKARU}
        facing=se

        {FACTION_SIDE:ARAGWAITHI}
        recruit={RECRUITS:ARAGWAITHI}

        fog=no
        shroud=no

        {GOLD 50 40 25}
        {INCOME 2 1 0}
    [/side]

    # side: vampire
    [side]
        side=2
        controller=ai

        id="vampire_leader"
        generate_name=yes
        gender=female
        type={ON_DIFFICULTY "Vampire Noble" "Vampire Noble" "Mistress"}
        canrecruit=yes

        {FACTION_SIDE:VAMPIRES}

        recruit={RECRUITS:VAMPIRES}

        fog=no
        shroud=no

        {GOLD 30 50 70}
        {INCOME 3 6 8}
        village_support={ON_DIFFICULTY 5 6 8}

        [ai]
            time_of_day=dawn,morning,midday,afternoon,indoors
            grouping=defensive
            aggression=0.40
            caution=0.60
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }

            [goal]
                name=target
                [criteria]
                    side=1
                    canrecruit=yes
                [/criteria]
                value=100.00
            [/goal]
        [/ai]
        [ai]
            time_of_day=dusk,first_watch,midnight,second_watch,underground,deep_underground
            grouping=offensive
            aggression=0.75
            caution=0.25
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }

            [goal]
                name=target
                [criteria]
                    side=1
                    canrecruit=yes
                [/criteria]
                value=100.00
            [/goal]
        [/ai]
        [ai]
            grouping=offensive
            aggression=0.75
            caution=0.25
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }

            [goal]
                name=target
                [criteria]
                    side=1
                    canrecruit=yes
                [/criteria]
                value=100.00
            [/goal]
        [/ai]
    [/side]

    {STARTING_VILLAGES_ALL 2}

    # prestart event
    [event]
        name="prestart"

        # adjust recall costs
        {ADJUST_RECALL_COST 33 50 66}

        # objectives
        [objectives]
            side=1
            [objective]
                description= _ "Reach the southern edge of the map with Hikaru"
                condition=win
            [/objective]

            {PLAYER_LEADER_DEATH_OBJECTIVE}
            {TURNS_RUN_OUT}

            [gold_carryover]
                bonus=yes
                carryover_percentage=30
            [/gold_carryover]

            #ifdef EASY
            notes_string = _"Hint: "

            [note]
                description=_"Engage the isolated enemy units in groups of 2 or 3 units."
            [/note]
            [note]
                description=_"Use Eagle Riders to rush ahead and flank retreating enemies."
                [show_if]
                    [have_unit]
                        side=1
                        type="Aragwaith Eagle Rider"
                        count=0-5
                    [/have_unit]
                [/show_if]
            [/note]
            [note]
                description=_"Try to level up a Swordsman into a Guard."
            [/note]
            [note]
                description=_"Attack during the day, defend during the night."
            [/note]
            #endif

            [note]
                description=_"Recall costs are a fraction of the recruit cost."
            [/note]
        [/objectives]

        # scatter vampire units
        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Thin Blood" "Thin Blood" "Half Blood"})  2 15}
        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Gargoyle" "Marlgoyle" "Marlgoyle"}) 13 14}
        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Fledgeling" "Vampire Duelist" "Vampire Duelist"}) 21 12}

        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Thin Blood" "Half Blood" "Half Blood"}) 15 19}
        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Blood Apprentice" "Blood Apprentice" "Blood Manipulator"})  3 23}
        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Fledgeling" "Vampire Duelist" "Vampire Duelist"}) 22 22}

        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Thin Blood" "Thin Blood" "Half Blood"})  9 30}
        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Flesh Artisan" "Flesh Artisan" "Flesh Artisan"})  2 33}
        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Fledgeling" "Fledgeling" "Vampire Duelist"}) 20 35}

        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Fledgeling" "Vampire Duelist" "Vampire Duelist"})  7 41}
        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Gargoyle" "Marlgoyle" "Marlgoyle"}) 19 43}
        {GENERIC_UNIT 2 ({ON_DIFFICULTY "Blood Apprentice" "Blood Apprentice" "Blood Manipulator"})  9 52}
    [/event]

    # start event
    [event]
        name="start"

        # recall two pass veterans
        {NEED_VETERAN_SCOUT  7  4}
        {NEED_VETERAN_ADEPT  8  4}
    [/event]

    # turn of eagle rider arrival event
    [event]
        #ifndef HARD
        name="turn 3"
        #else
        name="turn 5"
        #endif

        {SCROLL_TO  3  3}
        
        # play sound of eagle shriek
        [sound]
            name=gryphon-shriek-1.ogg
        [/sound]

        # animate eagle riders arriving
        {FAKE_UNIT_MOVE  1  4  1  3  1 "Aragwaith Eagle Rider" ()}
        {GENERIC_UNIT 1 "Aragwaith Eagle Rider"  4  3}{ASSIGN_ID "eagle_rider1"}

        {FAKE_UNIT_MOVE  1  3  1  4  1 "Aragwaith Eagle Rider" ()}
        {GENERIC_UNIT 1 "Aragwaith Eagle Rider"  3  4}

        # one more on lower difficulties
        #ifndef HARD
        {FAKE_UNIT_MOVE  1  5  1  3  1 "Aragwaith Eagle Rider" ()}
        {GENERIC_UNIT 1 "Aragwaith Eagle Rider"  5  3}
        #endif

        # TODO: Add dialogue here

        #ifdef EASY
        {DISPLAY_HINT_MESSAGE ( _ "The <i><b>Aragwaith Eagle Riders</b></i> are capable of moving fast and mostly serve the role of scouts. They have a <i>blade</i> attack as well as an <i>impact</i> attack that is only usable during attacking. Utilize the high mobility and attacking power of these units to flank isolated enemy units and disallow them to retreat.")}
        #endif

    [/event]

    # player leader moveto event (victory)
    [event]
        name="moveto"
        first_time_only=yes

        [filter]
            id="Hikaru"
            x=1-22
            y=53
        [/filter]

        # TODO: add dialogue here
        {ENDLEVEL_VICTORY yes 30}
    [/event]

    # we add a bonus item here
    [item]
        halo="halo/elven/shyde-stationary-halo1.png:150,halo/elven/shyde-stationary-halo2.png:150,halo/elven/shyde-stationary-halo3.png:150,halo/elven/shyde-stationary-halo4.png:150,halo/elven/shyde-stationary-halo5.png:150,halo/elven/shyde-stationary-halo6.png:150"
        visible_in_fog=yes
        x=20
        y=45
    [/item]

    [event]
        name="moveto"
        first_time_only=yes

        [filter]
            side=1
            x=20
            y=45
        [/filter]

        [remove_item]
            x,y=20,45
        [/remove_item]

        {NAMED_LOYAL_UNIT 1 (Faerie Sprite) 20 45 "Pyrah" ( _ "Pyrah")}
        [+unit]
            unrenamable=yes
            placement=map
            passable=yes
            #ifdef EASY
            # give her best possible trait combination on EASY
            [modifications]
                {TRAIT_RESILIENT}
                {TRAIT_DEXTROUS}
            [/modifications]
            #endif
        [/unit]

        # TODO: add dialogue here
    [/event]

    # enemy leader defeat event
    [event]
        name="last breath"

        [filter]
            side=2
            canrecruit=yes
        [/filter]

        # TODO: add dialogue
    [/event]

    # add a last breath event for faerie
    [event]
        name="last breath"

        [filter]
            id="Pyrah"
        [/filter]

        # TODO: add dialogue here
    [/event]

    # time over event
    [event]
        name="time over"

        {ENDLEVEL_DEFEAT}
    [/event]

    # loot at vampire keep
    {LOOT_CHEST_OF_GOLD 1 ({ON_DIFFICULTY 50 40 30}) 17 33}

    # player leader death event
    {DEFEAT_EVENT:HIKARU}
[/scenario]