#textdomain wesnoth-Electrifyre

[scenario]
    id=05_The_Mage_and_the_Sword
    next_scenario=06_Forsaken_Hall
    name=_"The Mage and the Sword"

    map_file=05_The_Mage_and_the_Sword.map

    victory_when_enemies_defeated=no
    {TURNS 28 26 26}
    {CAMPAIGN_XP_MODIFIER}
    
    {DEFAULT_MUSIC_PLAYLIST}
    {DEFAULT_SCHEDULE}

    # inside the fortress schedule
    [time_area]
        x= 0-26,4-22,6-20
        y=17-45,  16,  15
        {INDOORS}
    [/time_area]
    [time_area]
        x=  2-3,23-24
        y=16-20,16-20
        {UNDERGROUND}
    [/time_area]

    {STORY_FIVE}

    # side: player
    [side]
        side=1
        controller=human
        
        {CHARACTER_STATS:HIKARU}
        facing=se

        {FACTION_SIDE:ARAGWAITHI}
        recruit={RECRUITS:ARAGWAITHI}

        fog=yes
        shroud=yes
        share_vision=all

        {GOLD 110 100 90}
        {INCOME 3 2 2}
        village_support={ON_DIFFICULTY 5 4 3}
    [/side]

    {STARTING_VILLAGES 1 7}

    # side: allied aragwaithi
    [side]
        side=2
        controller=ai

        id="Ryuuma"
        # inspiration: Shimotsuki Ryuma (One Piece)
        name=_"Ryuuma"
        type="Aragwaith Shield Guard"
        canrecruit=yes
        facing=se
        unrenamable=yes
        [modifications]
            {TRAIT_RESILIENT}
            {TRAIT_RESISTANT}
            {TRAIT_FORTIFIED}
        [/modifications]

        team_name="aragwaithi"
        user_team_name=_"team_name^Aragwaithi"
        {FLAG_VARIANT long}
        color=purple

        recruit={RECRUITS:ARAGWAITHI}

        fog=yes
        shroud=yes
        share_vision=all

        {GOLD 240 220 200}
        {INCOME 10 10  8}

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping offensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.55}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.30}
            {AI_SIMPLE_ALWAYS_ASPECT passive_leader yes}
            # add more stronger AI params
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }

            [goal]
                name=target
                [criteria]
                    side=3
                    canrecruit=yes
                [/criteria]
                value=100.00
            [/goal]
        [/ai]
    [/side]

    {STARTING_VILLAGES 2 8}

    # limit some recruits of the ally
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Aragwaith Guard" {ON_DIFFICULTY 3 3 2}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Aragwaith Adept" {ON_DIFFICULTY 2 2 2}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Aragwaith Strongbow" {ON_DIFFICULTY 3 2 2}}

    # side: elementals and dwarves
    [side]
        side=3
        controller=ai

        id="Mage_Leader"
        name=_"Lady Laraina"
        gender=female
        type="Great Mage"
        canrecruit=yes
        facing=se
        unrenamable=yes
        [modifications]
            {TRAIT_RESILIENT}
            {TRAIT_RESISTANT}
            {TRAIT_FORTIFIED}
            [object]
                [effect]
                    apply_to=resistance
                    replace=yes
                    [resistance]
                        blade=0
                        pierce=0
                        impact=0

                        fire=0
                        cold=0
                        arcane=0

                        electric=100
                        energy=0
                        arcane_focus=0
                    [/resistance]
                [/effect]
                [effect]
                    apply_to=new_ability
                    [abilities]
                        [spectral_barrier]
                            id="mage_lord_spectral_armour"
                            name=_"spectral barrier"
                            description=_"This unit is manifesting a spectral barrier around itself which makes them nearly invulnerable to almost all damage types. Only electric weapons can penetrate the barrier."
                        [/spectral_barrier]
                    [/abilities]
                [/effect]
            [/object]
        [/modifications]

        fog=no
        shroud=no

        {FACTION_SIDE:ELEMENTALS}

        {GOLD 220 240 300}
        {INCOME 3 6 8}
        village_support={ON_DIFFICULTY  8 10 12}

        recruit={RECRUITS:ELEMENTALS}

        [ai]
            {AI_SIMPLE_ALWAYS_ASPECT grouping defensive}
            {AI_SIMPLE_ALWAYS_ASPECT aggression 0.55}
            {AI_SIMPLE_ALWAYS_ASPECT caution 0.30}
            {AI_SIMPLE_ALWAYS_ASPECT passive_leader no}
            # add more stronger AI params
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_diversity 0.8}
            {AI_SIMPLE_ALWAYS_ASPECT recruitment_randomness 0}
            {AI_SIMPLE_ALWAYS_ASPECT villages_per_scout 0}
            {AI_ASPECT recruitment_save_gold {AI_DEACTIVATE_SAVE_GOLD} }

            [goal]
                name=target
                [criteria]
                    side=1
                    canrecruit=yes
                [/criteria]
                value=70.00
            [/goal]

            [goal]
                name=target
                [criteria]
                    side=2
                    canrecruit=yes
                [/criteria]
                value=30.00
            [/goal]
        [/ai]
    [/side]

    # add some limitations
    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 "Ice Ghost" {ON_DIFFICULTY 2 2 3}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 "Unstable Elemental" {ON_DIFFICULTY 3 3 4}}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 3 "Fire Guardian" {ON_DIFFICULTY 4 5 6}}

    {STARTING_VILLAGES 3 2}

    {PLACE_IMAGE "items/dragonstatue.png"  9 30}
    {PLACE_IMAGE "items/dragonstatue.png~FL(horiz)" 17 30}

    # prestart event
    [event]
        name="prestart"

        # adjust recall costs
        {ADJUST_RECALL_COST 33 50 66}

        # objectives
        [objectives]
            side=1
            [objective]
                description= _ "Retrieve the Electrifyre"
                condition=win
                [show_if]
                    {VARIABLE_CONDITIONAL sword_electrifyre_picked equals no}
                [/show_if]
            [/objective]
            [objective]
                description= _ "Defeat the leader of the Mages and Dwarves"
                condition=win
                [show_if]
                    {VARIABLE_CONDITIONAL sword_electrifyre_picked equals yes}
                [/show_if]
            [/objective]

            {PLAYER_LEADER_DEATH_OBJECTIVE}

            [objective]
                description= _ "Death of Ryuuma"
                condition=lose
            [/objective]

            {TURNS_RUN_OUT}
            {IS_LAST_SCENARIO}

            [gold_carryover]
                bonus=yes
                carryover_percentage=30
            [/gold_carryover]

            #ifdef EASY
            notes_string = _"Hint: "

            [note]
                description=_"Try to enter the castle from a side-route."
            [/note]
            [note]
                description=_"Recall an Aragwaith Enchantress or Sorceress."
            [/note]
            #endif

            [note]
                description=_"Recall costs are a fraction of the recruit cost."
            [/note]
            [note]
                description=_"Only Electrifyre can damage the Mage Lord."
                [show_if]
                    {VARIABLE_CONDITIONAL sword_electrifyre_picked equals yes}
                [/show_if]
            [/note]
        [/objectives]

        # extend recruit list of side 3
        #ifdef EASY
        [allow_recruit]
            side=3
            type="Dwarvish Fighter, Dwarvish Guardsman, Dwarvish Stalwart, Dwarvish Crossbowman, Dwarvish Marksman"
        [/allow_recruit]
        #else
        [allow_recruit]
            side=3
            type="Dwarvish Fighter, Dwarvish Steelclad, Dwarvish Guardsman, Dwarvish Stalwart, Dwarvish Crossbowman, Dwarvish Marksman"
        [/allow_recruit]
        #endif

        # let aragwaithi recruit some veterans
        [allow_recruit]
            side=2
            type="Aragwaith Guard, Aragwaith Strongbow, Aragwaith Adept"
        [/allow_recruit]

        # give ally a healer
        {LOYAL_UNIT 2 "Aragwaith Enchantress" 22  2}
        [+unit]
            [modifications]
                {TRAIT_FORTIFIED}
                {TRAIT_RESILIENT}
            [/modifications]
        [/unit]
        # and a scout
        {GENERIC_UNIT 2 "Aragwaith Lancer" 22  3}

        # and some more level 1 units
        {GENERIC_UNIT 2 "Aragwaith Spearman" 22 3}
        {GENERIC_UNIT 2 "Aragwaith Swordsman" 22 3}
        {GENERIC_UNIT 2 "Aragwaith Spearman" 22 3}

        {GENERIC_UNIT 2 "Aragwaith Spearman" 22 3}
        {GENERIC_UNIT 2 "Aragwaith Swordsman" 22 3}
        {GENERIC_UNIT 2 "Aragwaith Spearman" 22 3}

        # place guardian units on the castle gates
        {FORTIFIED_UNIT 3 "Dwarvish Sentinel"  8 15}
        {FORTIFIED_UNIT 3 "Dwarvish Sentinel"  9 15}
        {FORTIFIED_UNIT 3 "Dwarvish Sentinel" 10 15}
        {FORTIFIED_UNIT 3 "Dwarvish Sentinel" 11 15}

        {FORTIFIED_UNIT 3 "Dwarvish Sentinel" 15 15}
        {FORTIFIED_UNIT 3 "Dwarvish Sentinel" 16 15}
        {FORTIFIED_UNIT 3 "Dwarvish Sentinel" 17 15}
        {FORTIFIED_UNIT 3 "Dwarvish Sentinel" 18 15}

        {FORTIFIED_UNIT 3 "White Mage" 11 16}
        {FORTIFIED_UNIT 3 "White Mage"  9 16}
        {FORTIFIED_UNIT 3 "White Mage" 15 16}
        {FORTIFIED_UNIT 3 "White Mage" 17 16}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman"  4 34}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman"  5 35}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman"  5 36}
        {GENERIC_STATIONED_UNIT 3 "Adept of Light"  4 35}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 22 34}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 21 35}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 21 36}
        {GENERIC_STATIONED_UNIT 3 "Adept of Light" 22 35}

        # place berserk units next to the item
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Ulfserker" 12 38}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Ulfserker" 12 39}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Ulfserker" 14 38}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Ulfserker" 14 39}

        {LOYAL_UNIT 3 "Mage"  8 27}{GUARDIAN}
        {LOYAL_UNIT 3 "Spearman"  7 27}{GUARDIAN}
        {LOYAL_UNIT 3 "Infantryman"  8 26}{GUARDIAN}
        {LOYAL_UNIT 3 "Spearman"  9 27}{GUARDIAN}

        {LOYAL_UNIT 3 "Mage" 18 27}{GUARDIAN}
        {LOYAL_UNIT 3 "Spearman" 17 27}{GUARDIAN}
        {LOYAL_UNIT 3 "Infantryman" 18 26}{GUARDIAN}
        {LOYAL_UNIT 3 "Spearman" 19 27}{GUARDIAN}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Thunderer"  3 26}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Thunderer"  4 26}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Thunderer" 22 26}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Thunderer" 23 26}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 11 31}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 12 30}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 11 33}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 12 33}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 14 30}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 15 31}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 14 33}
        {GENERIC_STATIONED_UNIT 3 "Dwarvish Guardsman" 15 33}

        {GENERIC_STATIONED_UNIT 3 "Dwarvish Stalwart" 13 27}

        # micro ai for side 2
        [micro_ai]
            side=2
            ai_type=goto
            action=add
            [filter_location]
                x=21,21,22,22,23,24,13
                y= 2, 3, 1, 3, 2,10, 4
            [/filter_location]
            [filter]
                side=2
                formula="if(self.hitpoints <= self.max_hitpoints / 3, 1, 0)"
            [/filter]
            release_unit_at_goal=yes
            remove_movement=no
            unique_goals=yes
        [/micro_ai]
    [/event]

    # start event
    [event]
        name="start"

        # recall two pass veterans
        {NEED_VETERAN_SCOUT  2  3}
        {NEED_VETERAN_ADEPT  3  2}

        # recall a veteran soldier
        [role]
            role=veteran_soldier
            [auto_recall][/auto_recall]

            type="Aragwaith Captain,Aragwaith Swordsmaster," +
                "Aragwaith Shield Guard,Aragwaith Guardian," +
                "Aragwaith Pikeman,Aragwaith Guard," +
                "Aragwaith Longswordsman,Aragwaith Flagbearer"
        [/role]

        # dialogue
        {SIMPLE_MSG "veteran_scout" ( _ "Hikaru, the southern trail ends here!")}

        {SIMPLE_MSG "veteran_adept" ( _ "There seems to be a castle up ahead. I sense a great magic power inside the castle.")}

        {SIMPLE_MSG "Hikaru" ( _ "We should proceed with caution. We cannot let Electrifyre fall into the wrong hands. It must be returned to its shrine!")}

        {SIMPLE_MSG "Ryuuma" ( _ "Hello, fellow kinsmen. What brings you here?")}

        {SIMPLE_MSG "Hikaru" ( _ "Our village had been robbed of its relic, and we are here to take it back.")}

        {SIMPLE_MSG "Ryuuma" ( _ "Another village has also been plundered for a long-forgotten relic? I was dispatched here from the Royal Capital to investigate and put a stop to these crimes. Let us unite our forces and take down these enemies!")}

        {SIMPLE_MSG "Hikaru" ( _ "Of course!")}

        #ifdef EASY
        {DISPLAY_HINT_MESSAGE ( _ "Your ally will keep the enemy engaged outside the fortress. What you have to do is form an initial group of veteran units and inflitrate (sneak into) the fortress from one of the side passages.")}

        {DISPLAY_HINT_MESSAGE ( _ "You should be able to utilise the tactics on playing Aragwaithi from the previous scenario is this battle such using Guards and Pikemen as damage absorbers or using Adepts or Enchantresses to heal.")}
        #endif
    [/event]

    # turn 2 event
    [event]
        name="turn 2"

        {SIMPLE_MSG "Hikaru" ( _ "Lord Knight, may I know your name?")}

        {SIMPLE_MSG "Ryuuma" ( _ "I am Ryuuma of House Shimotsuki")}

        {SIMPLE_MSG "veteran_adept" ( _ "House Shimotsuki?!")}

        {SIMPLE_MSG "Hikaru" ( _ "Are you really..?")}

        {SIMPLE_MSG "Ryuuma" ( _ "Yes, I am the very same. I sometimes do feel my feats in that war are a bit exaggerated though.")}
    [/event]

    # side 2 turn 3 event
    [event]
        name="side 2 turn 3"

        {SIMPLE_MSG "Ryuuma" ( _ "Hikaru, try taking your band and infiltrate the castle from a side passage. We shall keep the main enemy force distracted outside.")}

        {SIMPLE_MSG "Hikaru" ( _ "As you command, Lord Ryuuma!")}
    [/event]

    # let ally get gold
    [event]
        name="die"
        first_time_only=no

        [filter]
            side=2
            canrecruit=no
        [/filter]

        [gold]
            side=2
            amount={ON_DIFFICULTY 15 13 12}
        [/gold]
    [/event]

    # enemy leader sighted event
    [event]
        name="sighted"
        first_time_only=yes

        [filter]
            id="Mage_Leader"
        [/filter]
        [filter_second]
            side=1,2
        [/filter_second]

        {SIMPLE_MSG "Mage_Leader" ( _ "What do we have here? Have you come to retrieve the relics I requisitioned from you?")}

        {SIMPLE_MSG "Ryuuma" ( _ "I do not know why you stole so many relics from the villages and towns, but I shall ensure you return all of them!")}

        {SIMPLE_MSG "Mage_Leader" ( _ "You're too late, knight. I already sent over most of them. Just a recently stolen one is left.")}

        {SIMPLE_MSG "Hikaru" ( _ "That must be the Electrifyre! Quick, we must retrieve it!")}

        {SIMPLE_MSG "Ryuuma" ( _ "Focus on that mage leader! She must be brought to justice!")}

        #ifdef EASY
        {DISPLAY_HINT_MESSAGE ( _ "If you check the resistances of the enemy leader, you can see that only <i>electric</i> damage attacks can hurt her. Check out the nearby locations, there might be some relic/artifact which can give you this damage type attack.")}
        #endif
    [/event]

    # empower fire guardian event
    [event]
        name="recruit"
        first_time_only=no

        [filter]
            side=3
            type="Fire Guardian"
        [/filter]

        # add extra trait
        [modify_unit]
            [filter]
                x,y=$x1,$y1
            [/filter]

            {TRAIT_RESILIENT}
        [/modify_unit]
    [/event]

    # empower ice ghost event
    [event]
        name="recruit"
        first_time_only=no

        [filter]
            side=3
            type="Ice Ghost"
        [/filter]

        # add extra trait
        [modify_unit]
            [filter]
                x,y=$x1,$y1
            [/filter]

            {TRAIT_STRONG}
        [/modify_unit]
    [/event]

    # special events related to enemy leader
    # hitting enemy leader with a unit with no electrifyre equipped
    [event]
        name="attacker hits"
        first_time_only=yes

        [filter_attack]
            [not]
                type=electric
            [/not]
        [/filter_attack]
        [filter_second]
            side=3
            canrecruit=yes
            id="Mage_Leader"
        [/filter_second]

        {SIMPLE_MSG "Mage_Leader" ( _ "Such weapons cannot wound me, fools! Do you think, I, one of the seven mage masters will fall to such pathetic attempts?")}

        {SIMPLE_MSG "Ryuuma" ( _ "Hmm, she seems to be protected by a magical shield. Maybe we can find something inside the castle that can dissipate it. Quickly, search!")}
    [/event]

    [event]
        name="attacker hits"
        first_time_only=no

        [filter_attack]
            [not]
                type=electric
            [/not]
        [/filter_attack]
        [filter_second]
            side=3
            canrecruit=yes
            id="Mage_Leader"
        [/filter_second]

        # heal the mage
        [heal_unit]
            [filter]
                side=3
                canrecruit=yes
                id="Mage_Leader"
            [/filter]

            amount=$damage_inflicted
            animate=yes
        [/heal_unit]
    [/event]

    # hitting enemy leader with a unit with electrifyre
    [event]
        name="attacker hits"
        first_time_only=yes

        [filter_attack]
            type=electric
        [/filter_attack]
        [filter_second]
            side=3
            canrecruit=yes
            id="Mage_Leader"
        [/filter_second]

        {SIMPLE_MSG "Hikaru" ( _ "It seems striking her with the Electrifyre distorts the barrier she has been using! This seems to be the key to defeating her!")}
    [/event]

    # killing enemy leader with a unit with no electrifyre equipped
    [event]
        name="last breath"
        first_time_only=no

        [filter]
            side=3
            canrecruit=yes
            id="Mage_Leader"
        [/filter]
        [filter_second_attack]
            [not]
                type=electric
            [/not]
        [/filter_second_attack]

        # heal the mage
        [heal_unit]
            [filter]
                side=3
                canrecruit=yes
                id="Mage_Leader"
            [/filter]

            amount=20
            animate=yes
        [/heal_unit]
    [/event]

    # killing enemy leader with a unit with electrifyre
    [event]
        name="last breath"
        # first_time_only=yes

        [filter]
            side=3
            canrecruit=yes
            id="Mage_Leader"
        [/filter]
        [filter_second_attack]
            type=electric
        [/filter_second_attack]

        {SIMPLE_MSG "Hikaru" ( _ "<i>(launches a ferociously skilled slash)</i> Take that!")}

        {SIMPLE_MSG "Mage_Leader" ( _ "Argh! This weapon... My barrier has been broken!")}
    [/event]

    [event]
        name="die"

        [filter]
            side=3
            canrecruit=yes
            id="Mage_Leader"
        [/filter]

        {SIMPLE_MSG "Ryuuma" ( _ "Well done, everyone! Let us withdraw to Hikaru's village.")}

        [set_sub_achievement]
            content_for=wol_electrifyre_achievements
            id=WoL_Electrifyre_complete_standard
            sub_id=WoL_Electrifyre_scenario4
        [/set_sub_achievement]
        #ifdef HARD
        [set_sub_achievement]
            content_for=wol_electrifyre_achievements
            id=WoL_Electrifyre_complete_elite
            sub_id=WoL_Electrifyre_scenario4_hard
        [/set_sub_achievement]
        #endif

        # alternate macro for the last scenario
        {ENDLEVEL_VICTORY_NO_REPORT}
    [/event]

    # special moveto event 
    # for unlocking the side gates
    # left/east gate
    [event]
        name="moveto"
        first_time_only=yes

        [filter]
            side=1,2
            x= 2, 3
            y=20,20
        [/filter]

        [sound]
            name=mace.wav
        [/sound]

        [terrain]
            x=2, 3
            y=21,21
            terrain=Isr^Pr/o
        [/terrain]

        [redraw]
        [/redraw]
    [/event]

    # right/west gate
    [event]
        name="moveto"
        first_time_only=yes

        [filter]
            side=1,2
            x=23,24
            y=20,20
        [/filter]

        [sound]
            name=mace.wav
        [/sound]

        [terrain]
            x=23,24
            y=21,21
            terrain=Isr^Pr\o
        [/terrain]

        [redraw]
        [/redraw]
    [/event]

    # add recall event for faerie
    [event]
        name="recall"

        [filter]
            side=1
            id="Pyrah"
        [/filter]

        {SIMPLE_MSG "Pyrah" ( _ "Do you have need of my magic?")}

        {SIMPLE_MSG "Hikaru" ( _ "Yes, please assist us in this battle, Pyrah.")}

        {SIMPLE_MSG "Pyrah" ( _ "Very well.")}
    [/event]

    # add a last breath event for faerie
    [event]
        name="last breath"

        [filter]
            id="Pyrah"
        [/filter]

        {SIMPLE_MSG "Pyrah" ( _ "I should have stayed in my tree...")}
    [/event]

    # place the titular item
    {ITEM_ELECTRIFYRE 13 39}

    # add event if unit other than hikaru 
    # tries to pick it up
    [event]
        name="moveto"
        first_time_only=yes

        [filter]
            side=1
            x,y=13,39
        [/filter]

        {SIMPLE_MSG unit ( _ "Hey! I found Electrifyre! It's here! Hikaru, come quick! Take it!")}
    [/event]

    # player leader death event
    {DEFEAT_EVENT:HIKARU}

    # death event for the allied leader
    [event]
        name="last breath"

        [filter]
            id="Ryumma"
        [/filter]

        {SIMPLE_MSG "Ryuuma" ( _ "How can I be defeated like this?")}
    [/event]

    [event]
        name="die"

        [filter]
            id="Ryuuma"
        [/filter]

        {ENDLEVEL_DEFEAT}
    [/event]

    # loot chests
    {LOOT_CHEST_OF_GOLD  1 12  9 35}
    {LOOT_CHEST_OF_GOLD  1 12 10 35}
    {LOOT_CHEST_OF_GOLD  1 12 16 35}
    {LOOT_CHEST_OF_GOLD  1 12 17 35}

    # time over event
    [event]
        name="time over"

        {SIMPLE_MSG "Mage_Leader" ( _ "Haha! My teleportation is complete! ")}

        {FLASH_WHITE (
            [kill]
                id="Mage Leader"
                animate=no
                fire_event=no
            [/kill]
        )}

        {SIMPLE_MSG "Ryuuma" ( _ "The pesky mage has escaped! Who knows more she has stolen from us!")}

        {SIMPLE_MSG "Ryuuma" ( _ "We have failed this mission...")}

        {ENDLEVEL_DEFEAT}
    [/event]

    # load resource from WoL
    # curse and terrain link
    [load_resource]
        id=WOL_resource_abilities_events_nightmares
    [/load_resource]
[/scenario]